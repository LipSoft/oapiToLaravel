<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;
use App\{{{name}}};
{{#belongsTo}}    
use App\{{{referencedTableName}}};
{{/belongsTo}}
{{#hasMany}}    
use App\{{{tableName}}};
{{/hasMany}}

class {{{name}}}Controller extends Controller
{

    public function index()
    {      
        return {{{name}}}::all()
        {{#belongsTo}}    
        ->with('{{{referencedTableName}}}')
        {{/belongsTo}}
        {{#hasMany}}           
        //->with('{{{tableName}}}')
        {{/hasMany}}
        ;  
    }

    public function create()
    {
        return view('{{{name}}}.create', [
{{#belongsTo}} 
            '{{{referencedTableName}}}' => {{{referencedTableName}}}::all(),
{{/belongsTo}}
{{#hasMany}}   
            //'{{{tableName}}}' => {{{tableName}}}::all(),
{{/hasMany}}
        ]);
    }

    public function show($id)
    {
        return {{{name}}}::find($id)
        {{#belongsTo}}    
        ->with('{{{referencedTableName}}}')
        {{/belongsTo}}
        {{#hasMany}}           
        //->with('{{{tableName}}}')
        {{/hasMany}}
        ;
    }

    public function edit($id)
    {
        return view('{{{name}}}.edit', [
{{#belongsTo}} 
            '{{{referencedTableName}}}' => {{{referencedTableName}}}::all(),
{{/belongsTo}}
            '{{{name}}}' => {{{name}}}::find($id)
            {{#belongsTo}}    
            ->with('{{{referencedTableName}}}')
            {{/belongsTo}}
            {{#hasMany}}           
            //->with('{{{tableName}}}')
            {{/hasMany}}
         ]);
    }

    public function store(Request $request)
    {              
        ${{{name}}} = new {{{name}}};
        {{#fields}}
        if (isset($request->{{{field}}})) ${{{name}}}->{{{field}}} = $request->{{{field}}};                        
        {{/fields}}
        
        ${{{name}}}->save();
        return ${{{name}}};
    }
    
    public function update(Request $request, $id)
    {
        ${{{name}}} = {{{name}}}::find($id);
        {{#fields}}
        if (isset($request->{{{field}}})) ${{{name}}}->{{{field}}} = $request->{{{field}}};                              
        {{/fields}}
        
        ${{{name}}}->save();
        return ${{{name}}};
    }

    public function destroy($id)
    {
        return {{{name}}}::destroy($id);
    }
}
